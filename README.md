# AI Chat Hub

A multi-provider AI chat application supporting OpenAI, Anthropic (Claude), and Google (Gemini) with token tracking and cost management.

## Features

- ü§ñ **Multi-Provider Support**: OpenAI, Anthropic, Google
- üí¨ **Conversation Management**: Save and load chat history
- üîê **Secure Authentication**: Email/password and Google OAuth
- üîë **API Key Management**: Encrypted storage per user
- üí∞ **Cost Tracking**: Real-time token usage and cost calculation
- üìä **Usage Statistics**: Track tokens and spending in sidebar
- üé® **Clean UI**: Dark/light mode, responsive design

## Quick Start

### 1. Install Dependencies
```bash
pip install -r requirements.txt
```

### 2. Configure Environment
Create `.env` file:
```env
FLASK_SECRET_KEY=your-secret-key-here
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

# Optional: Fallback API keys
OPENAI_API_KEY=your-openai-key
ANTHROPIC_API_KEY=your-anthropic-key
GEMINI_API_KEY=your-gemini-key
```

### 3. Run Application
```bash
python app.py
```

Visit: http://localhost:5000

## Project Structure

```
AI-MODEL-/
‚îú‚îÄ‚îÄ app.py                 # Main application entry point
‚îú‚îÄ‚îÄ config.py              # Configuration management
‚îú‚îÄ‚îÄ models/                # Data models & pricing
‚îÇ   ‚îî‚îÄ‚îÄ pricing.py
‚îú‚îÄ‚îÄ routes/                # Route handlers
‚îÇ   ‚îú‚îÄ‚îÄ auth.py           # Authentication
‚îÇ   ‚îú‚îÄ‚îÄ chat.py           # Chat functionality
‚îÇ   ‚îî‚îÄ‚îÄ api.py            # API endpoints
‚îú‚îÄ‚îÄ services/              # Business logic
‚îÇ   ‚îú‚îÄ‚îÄ user_service.py   # User management
‚îÇ   ‚îî‚îÄ‚îÄ ai_service.py     # AI provider integration
‚îú‚îÄ‚îÄ templates/             # HTML templates
‚îÇ   ‚îú‚îÄ‚îÄ index.html        # Main chat interface
‚îÇ   ‚îî‚îÄ‚îÄ login.html        # Login page
‚îî‚îÄ‚îÄ static/                # Static assets (future)
```

## Architecture

The application follows a clean, modular architecture:

- **Routes**: Handle HTTP requests/responses
- **Services**: Implement business logic
- **Models**: Define data structures and calculations
- **Config**: Centralized configuration

See [ARCHITECTURE.md](ARCHITECTURE.md) for detailed architecture documentation.

## Documentation

- [README.md](README.md) - This file
- [STORAGE_GUIDE.md](STORAGE_GUIDE.md) - **Storage strategy & when to migrate**
- [PROJECT_STRUCTURE.md](PROJECT_STRUCTURE.md) - Detailed project structure
- [ARCHITECTURE.md](ARCHITECTURE.md) - System architecture and data flow
- [REFACTORING_SUMMARY.md](REFACTORING_SUMMARY.md) - Refactoring details
- [TOKEN_TRACKING.md](TOKEN_TRACKING.md) - Token tracking implementation

## API Providers

### OpenAI
- GPT-4o, GPT-4o Mini, GPT-4 Turbo, GPT-3.5 Turbo
- Get API key: https://platform.openai.com/api-keys

### Anthropic (Claude)
- Claude Sonnet 4, Claude 3.5 Sonnet, Claude 3.5 Haiku, Claude 3 Opus
- Get API key: https://console.anthropic.com/settings/keys

### Google (Gemini)
- Gemini 2.5 Flash, Gemini 2.5 Pro, Gemini 2.0 Flash, Gemini 1.5 Pro
- Get API key: https://aistudio.google.com/app/apikey

## Usage

### 1. Sign Up / Login
- Create account with email/password
- Or sign in with Google

### 2. Add API Keys
- Click "Settings" in sidebar
- Enter API keys for providers you want to use
- Keys are encrypted and stored securely

### 3. Start Chatting
- Select provider and model
- Type your message
- View token usage and cost in sidebar

### 4. Manage Conversations
- Conversations auto-save
- Click on past conversations to load them
- Delete conversations you don't need

## Token Tracking

The app tracks:
- **Input tokens**: Tokens sent to the model
- **Output tokens**: Tokens generated by the model
- **Cost**: Real-time cost calculation based on provider pricing

Usage stats appear in the sidebar below the model selector.

## Security

- **Password Hashing**: pbkdf2:sha256
- **API Key Encryption**: Fernet symmetric encryption
- **Session Management**: Secure Flask sessions
- **OAuth 2.0**: Google authentication

## Development

### Run in Development Mode
```bash
python app.py
```

### Run Tests (future)
```bash
pytest
```

### Code Structure
- Follow PEP 8 style guide
- Use type hints where appropriate
- Keep functions small and focused
- Write docstrings for public APIs

## Deployment

### Production Server
```bash
gunicorn "app:create_app()" --bind 0.0.0.0:5000 --workers 4
```

### Docker (future)
```bash
docker build -t ai-chat-hub .
docker run -p 5000:5000 ai-chat-hub
```

## Environment Variables

| Variable | Required | Description |
|----------|----------|-------------|
| FLASK_SECRET_KEY | Yes | Secret key for sessions and encryption |
| GOOGLE_CLIENT_ID | For OAuth | Google OAuth client ID |
| GOOGLE_CLIENT_SECRET | For OAuth | Google OAuth client secret |
| OPENAI_API_KEY | No | Fallback OpenAI API key |
| ANTHROPIC_API_KEY | No | Fallback Anthropic API key |
| GEMINI_API_KEY | No | Fallback Google API key |

## Pricing (per 1M tokens)

### OpenAI
- GPT-4o: $2.50 / $10.00 (input/output)
- GPT-4o Mini: $0.15 / $0.60
- GPT-4 Turbo: $10.00 / $30.00
- GPT-3.5 Turbo: $0.50 / $1.50

### Anthropic
- Claude Sonnet 4: $3.00 / $15.00
- Claude 3.5 Sonnet: $3.00 / $15.00
- Claude 3.5 Haiku: $0.80 / $4.00
- Claude 3 Opus: $15.00 / $75.00

### Google
- Gemini 2.5 Flash: $0.10 / $0.40
- Gemini 2.5 Pro: $1.25 / $5.00
- Gemini 2.0 Flash: $0.10 / $0.40
- Gemini 1.5 Pro: $1.25 / $5.00

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Write tests
5. Submit a pull request

## License

MIT License - see LICENSE file for details

## Support

For issues and questions:
- Open an issue on GitHub
- Check documentation files
- Review architecture diagrams

## Roadmap

- [ ] Extract CSS/JS to static files
- [ ] Add unit tests
- [ ] Database migration (SQLAlchemy)
- [ ] Streaming responses
- [ ] Conversation export
- [ ] Image support for vision models
- [ ] Rate limiting
- [ ] Admin dashboard
- [ ] Team collaboration

## Acknowledgments

- OpenAI for GPT models
- Anthropic for Claude models
- Google for Gemini models
- Flask framework
- All open-source contributors
